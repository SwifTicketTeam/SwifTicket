<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SwifTicket API Documentation</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            max-width: 900px;
            margin: 2rem auto;
            padding: 1rem 2rem;
            line-height: 1.6;
            background-color: #fff;
            color: #222;
        }
        h1, h2, h3 {
            color: #444;
            margin-top: 2rem;
            border-bottom: 2px solid #eee;
            padding-bottom: 0.3rem;
        }
        code {
            background: #f5f5f5;
            padding: 0.2rem 0.4rem;
            font-size: 95%;
            border-radius: 3px;
        }
        pre {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
        }
        .method {
            font-weight: bold;
            color: #c94f4f;
        }
        .route {
            color: #333;
            padding: 0.5rem;
            border-radius: 0.2rem;
            background-color: #EEE;
        }
    </style>
</head>
<body>

<h1>SwifTicket API Documentation</h1>
<p>All RESTful API endpoints used across the SwifTicket platform.</p>

<h2>Server & Docs</h2>
<p><span class="method">GET</span> <span class="route">/</span> – Welcome message or server status</p>
<p><span class="method">GET</span> <span class="route">/api</span> – Returns this documentation</p>

<h2>Authentication</h2>

<p><span class="method">POST</span> <span class="route">/api/auth/register</span> – Register a user</p>
<pre>{
  "username": "john_doe",
  "email": "john@example.com",
  "password": "your_password"
}</pre>

<p><span class="method">POST</span> <span class="route">/api/auth/login</span> – Log in</p>
<pre>{
  "email": "john@example.com",
  "password": "your_password"
}</pre>

<p><span class="method">GET</span> <span class="route">/api/auth/verified?token=xyz</span> – Verify email</p>

<p><span class="method">POST</span> <span class="route">/api/auth/forgot-password</span> – Request password reset</p>
<pre>{
  "email": "john@example.com"
}</pre>

<p><span class="method">POST</span> <span class="route">/api/auth/reset-password</span> – Reset password</p>
<pre>{
  "password": "new_password",
  "token": "reset_token"
}</pre>

<p><span class="method">POST</span> <span class="route">/api/auth/jwt</span> – Validate JWT</p>
<pre>{
  "token": "your_jwt_token"
}</pre>

<h2>User Profile</h2>

<p><span class="method">POST</span> <span class="route">/api/uploads/images/users/:userid</span> – Upload user image (FormData)</p>
<p><span class="method">GET</span> <span class="route">/api/uploads/images/users/:userid</span> – Get profile image</p>

<p><span class="method">PUT</span> <span class="route">/api/account/users/:userid</span> – Edit user info</p>
<pre>{
  "username": "new_username",
  "email": "new_email@example.com",
  "bio": "Hello, world!"
}</pre>

<h2>Movies & Events</h2>

<p><span class="method">GET</span> <span class="route">/api/events/movies</span> – Get movie list</p>
<p>Optional query params: <code>?search=Title&genre=Action,Drama</code></p>

<p><span class="method">POST</span> <span class="route">/api/events/movies/screens</span> – Get screens by movie & date</p>
<pre>{
  "movieId": "abc123",
  "date": "2025-07-01"
}</pre>

<h2>Favorites</h2>

<p><span class="method">POST</span> <span class="route">/api/events/movies/users/favorites</span> – Check if movie is favorited</p>
<pre>{
  "userId": "user123",
  "movieId": "movie456"
}</pre>

<p><span class="method">POST</span> <span class="route">/api/account/movies/favorites</span> – Get all favorites</p>
<pre>{
  "userId": "user123"
}</pre>

<p><span class="method">PUT</span> <span class="route">/api/account/movies/favorites</span> – Add/remove favorite</p>
<pre>{
  "userId": "user123",
  "movieId": "movie456"
}</pre>

<h2>Theatre Management</h2>

<p><span class="method">POST</span> <span class="route">/api/account/theatres/create</span> – Create theatre</p>
<pre>{
  "vendor": "vendor_id",
  "city": "Chennai",
  "name": "Grand Cinema"
}</pre>

<p><span class="method">POST</span> <span class="route">/api/account/theatres/get</span> – Get vendor theatres</p>
<pre>{
  "vendor": "vendor_id"
}</pre>

<h2>Screen Management</h2>

<p><span class="method">POST</span> <span class="route">/api/account/theatres/screens/create</span> – Add screen</p>
<pre>{
  "city": "Chennai",
  "theatre": "Grand Cinema",
  "screenName": "Screen 1",
  "rows": 5,
  "cols": 10,
  "gaps": [[2, 4], [6, 7]]
}</pre>

<p><span class="method">POST</span> <span class="route">/api/account/theatres/screens/get</span> – Get all screens</p>
<pre>{
  "city": "Chennai",
  "theatre": "Grand Cinema"
}</pre>

<p><span class="method">POST</span> <span class="route">/api/account/theatres/screen/delete</span> – Delete screen</p>
<pre>{
  "city": "Chennai",
  "theatre": "Grand Cinema",
  "screenName": "Screen 1"
}</pre>

<h2>Movie Assignment</h2>

<p><span class="method">GET</span> <span class="route">/api/account/theatres/movies</span> – Get movies for vendor</p>

<p><span class="method">POST</span> <span class="route">/api/account/theatres/movie</span> – Assign movie to screen</p>
<pre>{
  "city": "Chennai",
  "theatre": "Grand Cinema",
  "screenName": "Screen 1",
  "movieId": "movie789",
  "time": "18:30"
}</pre>

<h2>Payments & Checkout</h2>

<p><span class="method">POST</span> <span class = "route">/api/payments/init</span></p>
<p>Starts the Stripe Checkout session and creates metadata for the ticket.</p>

<p><strong>Called via:</strong></p>
<pre><code>axios.post(`${process.env.VUE_APP_SERVER}/api/payments/init`, {
  amount: this.bookAmount * 100,
  email: this.$store.state.auth.email,
  metadata: {
    user: this.$store.state.auth.UID,
    movie: this.evt.title,
    movie_id: this.evt._id,
    seats: [...this.selectedSeats].sort().join(', '),
    theatre: `${this.selectedScreen.theatre}, ${this.selectedScreen.city}`,
    show: this.selectedShow.name,
    time: this.selectedShow.time,
    amount: this.bookAmount * (1 + this.ConvenienceFeesPercentage)
  }
})</code></pre>

<p><strong>Sample JSON Payload:</strong></p>
<pre>{
  "amount": 35000,
  "email": "user@example.com",
  "metadata": {
    "user": "user_id_123",
    "movie": "Movie Title",
    "movie_id": "movie_id_abc",
    "seats": "A1, A2",
    "theatre": "Grand Cinema, Mumbai",
    "show": "Evening Show",
    "time": "18:30",
    "amount": 350
  }
}
</pre>

<p><span class="method">POST</span> <span class = "route">/api/payments/success?session_id=xyz</span></p>
<p>Triggered after successful Stripe payment. Returns the stored metadata.</p>

<p><strong>Called via:</strong></p>
<pre><code>axios.post(`${process.env.VUE_APP_SERVER}/api/payments/success?session_id=${this.$route.query.session_id}`)
  .then(res => {
    this.ticket = res.data.metadata;
  });</code></pre>

<p><strong>Sample Response:</strong></p>
<pre>{
  "metadata": {
    "user": "user_id_123",
    "movie": "Movie Title",
    "movie_id": "movie_id_abc",
    "seats": "A1, A2",
    "theatre": "Grand Cinema, Mumbai",
    "show": "Evening Show",
    "time": "18:30",
    "amount": 350
  }
}
</pre>


</body>
</html>
